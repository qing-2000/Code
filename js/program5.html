<!DOCTYPE html>
<html>
<head>
    <title>幸运抽奖</title>
    <style>
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        .participant-input { margin: 20px 0; }
        #participantList { margin: 10px 0; }
        .participant {
            display: inline-block;
            padding: 5px 10px;
            margin: 5px;
            background: #f0f0f0;
            border-radius: 15px;
        }
        #winnerDisplay {
            font-size: 24px;
            font-weight: bold;
            color: #e74c3c;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .draw { background: #e74c3c; color: white; }
        .add { background: #3498db; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <h1>幸运抽奖程序</h1>
        
        <div class="participant-input">
            <input type="text" id="participantInput" placeholder="输入参与者姓名">
            <button class="add" onclick="addParticipant()">添加参与者</button>
            <button onclick="clearParticipants()">清空列表</button>
        </div>
        
        <div id="participantList"></div>
        
        <div>
            <button class="draw" onclick="drawWinner()">开始抽奖！</button>
        </div>
        
        <div id="winnerDisplay"></div>
        <div id="winnerList"></div>
    </div>

    <script>
        let participants = JSON.parse(localStorage.getItem('participants')) || [];
        let winners = JSON.parse(localStorage.getItem('winners')) || [];
        
        function addParticipant() {
            const input = document.getElementById('participantInput');
            const name = input.value.trim();
            
            if (name && !participants.includes(name)) {
                participants.push(name);
                input.value = '';
                saveParticipants();
                renderParticipants();
            } else if (participants.includes(name)) {
                alert('该参与者已存在！');
            }
        }
        
        function clearParticipants() {
            participants = [];
            saveParticipants();
            renderParticipants();
        }
        
        function drawWinner() {
            if (participants.length === 0) {
                alert('请先添加参与者！');
                return;
            }
            
            // 抽奖动画效果
            let count = 0;
            const maxCount = 20;
            const interval = setInterval(() => {
                const randomIndex = Math.floor(Math.random() * participants.length);
                document.getElementById('winnerDisplay').textContent = participants[randomIndex];
                count++;
                
                if (count >= maxCount) {
                    clearInterval(interval);
                    const finalWinner = participants[Math.floor(Math.random() * participants.length)];
                    document.getElementById('winnerDisplay').textContent = `恭喜: ${finalWinner}！`;
                    
                    // 添加到中奖名单
                    winners.push({
                        name: finalWinner,
                        time: new Date().toLocaleString()
                    });
                    saveWinners();
                    renderWinners();
                    
                    // 从参与者中移除（可选）
                    // participants = participants.filter(p => p !== finalWinner);
                    // saveParticipants();
                    // renderParticipants();
                }
            }, 100);
        }
        
        function renderParticipants() {
            const list = document.getElementById('participantList');
            list.innerHTML = participants.map(name => 
                `<span class="participant">${name}</span>`
            ).join('');
            
            document.getElementById('participantInput').focus();
        }
        
        function renderWinners() {
            const list = document.getElementById('winnerList');
            list.innerHTML = '<h3>中奖记录:</h3>' + winners.map(winner => 
                `<div>${winner.name} - ${winner.time}</div>`
            ).join('');
        }
        
        function saveParticipants() {
            localStorage.setItem('participants', JSON.stringify(participants));
        }
        
        function saveWinners() {
            localStorage.setItem('winners', JSON.stringify(winners));
        }
        
        // 键盘事件
        document.getElementById('participantInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addParticipant();
            }
        });
        
        // 初始化
        renderParticipants();
        renderWinners();
    </script>
</body>
</html>